#include "EnergyDependentCS.hpp"
#include <cmath> 

using namespace std; 

//_______________________________________________________________________________________
EnergyDependentCS::EnergyDependentCS(double _min, double _max, const std::vector<double>& _points)
    : 
    MeV_min(_min),
    MeV_max(_max),
    points(_points)
{
    MeV_span_log = log( MeV_max / MeV_min ); 
    
    MeV_spacing_log = MeV_span_log / ((double)points.size()-1);
}

//_______________________________________________________________________________________
double EnergyDependentCS::Compute_CS(double MeV) const
{
    //handle case of the energy being out-of-range
    if (MeV < MeV_min) return points.front(); 
    if (MeV > MeV_max) return points.back(); 

    //find out which point to take. 
    
    // it works like this: 
    // if MeV == MeV_min, we want to take the lowest energy point. 
    // and if MeV == MeV_max, we want to take the highest energy point. 
    // but, we have a number of point to get thru, so how do we interpolate? 
    // first, we get the rato of the highest and lowest eneries, and we switch to log-space. 

    double log_MeV  = log ( MeV / MeV_min ); 
    double index = log_MeV / MeV_spacing_log; 

    double MeV_floor = MeV_min * exp( floor(index)*MeV_spacing_log ); 
    double MeV_ceil  = MeV_floor * exp( MeV_spacing_log );   
    
    // now, linearly interpolate between them
    double CS_0 = points.at( floor(index) ); 
    double CS_1 = points.at( floor(index)+1 ); 

    return CS_0 + ( (CS_1 - CS_0) * (MeV - MeV_floor) / (MeV_ceil - MeV_floor) ); 
}

//_____________________________________________________________________________________________________________________________
EnergyDependentCSManager::EnergyDependentCSManager()
{
    //load in EDCS objects
    Fill_EDCS_Uranium(); 
}

EnergyDependentCSManager::~EnergyDependentCSManager()
{
    //delete arrays
    for (auto it = fEDCS.begin(); it != fEDCS.end(); it++) {
        if (it->second != nullptr) delete it->second; 
    }
    fEDCS.clear(); 
}

//_____________________________________________________________________________________________________________________________
vector<EventType> EnergyDependentCSManager::MakeEvents(const double enrichment_frac, const double num_density)
{
    //create all possible types of events (except leaving the sphere)

    vector<EventType> types; 

    const double dalt = GadgetUtils::one_dalton_in_MeV_c2; 
    
    const double b = GadgetUtils::barns_to_cm; 

    // 235u elastic 
    auto edcs_235_el = fEDCS["235u_Elastic"]; 
    types.push_back({
        EventType::kElastic, 
        [edcs_235_el, b](double MeV){ return edcs_235_el->Compute_CS(MeV) * b; }, 
        enrichment_frac*num_density, 
        235.*dalt
    }); 

    // 235u inelastic
    auto edcs_235_in = fEDCS["235u_Inelastic"]; 
    types.push_back({
        EventType::kInelastic, 
        [edcs_235_in, b](double MeV){ return edcs_235_in->Compute_CS(MeV) * b; }, 
        enrichment_frac*num_density, 
        235.*dalt
    }); 

    // 235u fission 
    auto edcs_235_f = fEDCS["235u_Fission"]; 
    types.push_back({
        EventType::kFission, 
        [edcs_235_f, b](double MeV){ return edcs_235_f->Compute_CS(MeV) * b; }, 
        enrichment_frac*num_density, 
        235.*dalt
    }); 

    // 235u n -> 2n 
    auto edcs_235_n2n = fEDCS["235u_N_2N"]; 
    types.push_back({
        EventType::kN_2N, 
        [edcs_235_n2n, b](double MeV){ return edcs_235_n2n->Compute_CS(MeV) * b; }, 
        enrichment_frac*num_density, 
        235.*dalt
    }); 

    // 235u n -> 3n 
    auto edcs_235_n3n = fEDCS["235u_N_3N"]; 
    types.push_back({
        EventType::kN_3N, 
        [edcs_235_n3n, b](double MeV){ return edcs_235_n3n->Compute_CS(MeV) * b; }, 
        enrichment_frac*num_density, 
        235.*dalt
    }); 




    // 238u elastic 
    auto edcs_238_el = fEDCS["238u_Elastic"]; 
    types.push_back({
        EventType::kElastic, 
        [edcs_238_el, b](double MeV){ return edcs_238_el->Compute_CS(MeV) * b; }, 
        (1. - enrichment_frac)*num_density, 
        238.*dalt
    }); 

    // 238u inelastic
    auto edcs_238_in = fEDCS["238u_Inelastic"]; 
    types.push_back({
        EventType::kInelastic, 
        [edcs_238_in, b](double MeV){ return edcs_238_in->Compute_CS(MeV) * b; }, 
        (1. - enrichment_frac)*num_density, 
        238.*dalt
    }); 

    // 238u fission
    auto edcs_238_f = fEDCS["238u_Fission"]; 
    types.push_back({
        EventType::kFission, 
        [edcs_238_f, b](double MeV){ return edcs_238_f->Compute_CS(MeV) * b; }, 
        (1. - enrichment_frac)*num_density, 
        238.*dalt
    }); 

    // 238u n -> 2n
    auto edcs_238_n2n = fEDCS["238u_N_2N"]; 
    types.push_back({
        EventType::kN_2N, 
        [edcs_238_n2n, b](double MeV){ return edcs_238_n2n->Compute_CS(MeV) * b; }, 
        (1. - enrichment_frac)*num_density, 
        238.*dalt
    }); 

    // 238u fission
    auto edcs_238_n3n = fEDCS["238u_N_3N"]; 
    types.push_back({
        EventType::kN_3N, 
        [edcs_238_n3n, b](double MeV){ return edcs_238_n3n->Compute_CS(MeV) * b; }, 
        (1. - enrichment_frac)*num_density, 
        238.*dalt
    }); 

    return types; 
}


//______________________________________________________________________________________________________________________________
void EnergyDependentCSManager::Fill_EDCS_Uranium()
{
    //species: "235u" reaction: "Elastic" from file: "json_data/235u_cross_sections.json"
    fEDCS["235u_Elastic"] = new EnergyDependentCS(2.61834000e-02, 2.96139000e+01, {
    +1.13431000e+01,
    +1.12767543e+01,
    +1.12253538e+01,
    +1.11995320e+01,
    +1.11724878e+01,
    +1.11441632e+01,
    +1.11144976e+01,
    +1.10834276e+01,
    +1.10437173e+01,
    +1.09951032e+01,
    +1.09441875e+01,
    +1.08908614e+01,
    +1.08350107e+01,
    +1.07930997e+01,
    +1.07524926e+01,
    +1.07099631e+01,
    +1.06654201e+01,
    +1.06165719e+01,
    +1.05471984e+01,
    +1.04745407e+01,
    +1.03984431e+01,
    +1.03187430e+01,
    +1.02478880e+01,
    +1.02065617e+01,
    +1.01632790e+01,
    +1.01179471e+01,
    +1.00543960e+01,
    +9.98688185e+00,
    +9.90939948e+00,
    +9.82530278e+00,
    +9.73722475e+00,
    +9.64862759e+00,
    +9.56238542e+00,
    +9.47206036e+00,
    +9.37745910e+00,
    +9.28156298e+00,
    +9.18551869e+00,
    +9.08492745e+00,
    +8.97957399e+00,
    +8.86923287e+00,
    +8.75366795e+00,
    +8.64296236e+00,
    +8.52745553e+00,
    +8.40648035e+00,
    +8.27977794e+00,
    +8.15685339e+00,
    +8.03506875e+00,
    +7.90751857e+00,
    +7.77392987e+00,
    +7.64528717e+00,
    +7.51670103e+00,
    +7.38202734e+00,
    +7.24097789e+00,
    +7.09325085e+00,
    +6.95722335e+00,
    +6.81522649e+00,
    +6.67169495e+00,
    +6.53571924e+00,
    +6.39330613e+00,
    +6.24415087e+00,
    +6.10479304e+00,
    +5.96438794e+00,
    +5.82911252e+00,
    +5.69269544e+00,
    +5.54982008e+00,
    +5.41709106e+00,
    +5.28338716e+00,
    +5.15465187e+00,
    +5.01982198e+00,
    +4.89615920e+00,
    +4.77258940e+00,
    +4.65059046e+00,
    +4.53463739e+00,
    +4.41947504e+00,
    +4.31241273e+00,
    +4.20713835e+00,
    +4.11002882e+00,
    +4.01494389e+00,
    +3.92712837e+00,
    +3.85540871e+00,
    +3.78487657e+00,
    +3.72505594e+00,
    +3.67502343e+00,
    +3.64204541e+00,
    +3.61449545e+00,
    +3.58564121e+00,
    +3.55542095e+00,
    +3.55772249e+00,
    +3.56098541e+00,
    +3.57691571e+00,
    +3.60390875e+00,
    +3.63837100e+00,
    +3.69028292e+00,
    +3.74465247e+00,
    +3.80159600e+00,
    +3.87187718e+00,
    +3.94591333e+00,
    +4.02345451e+00,
    +4.10466667e+00,
    +4.18414752e+00,
    +4.26048637e+00,
    +4.32966858e+00,
    +4.40212604e+00,
    +4.45331889e+00,
    +4.50348855e+00,
    +4.54957520e+00,
    +4.56112386e+00,
    +4.57321927e+00,
    +4.58588731e+00,
    +4.56960355e+00,
    +4.53819976e+00,
    +4.49783061e+00,
    +4.42833598e+00,
    +4.35555132e+00,
    +4.26335131e+00,
    +4.16145279e+00,
    +4.06374566e+00,
    +3.97013592e+00,
    +3.86362177e+00,
    +3.74361970e+00,
    +3.61361514e+00,
    +3.47583061e+00,
    +3.35190827e+00,
    +3.23807941e+00,
    +3.12224509e+00,
    +3.00220849e+00,
    +2.89005466e+00,
    +2.79879497e+00,
    +2.73482265e+00,
    +2.68461631e+00,
    +2.64764047e+00,
    +2.61928948e+00,
    +2.62222074e+00,
    +2.64858046e+00,
    +2.68787424e+00,
    +2.74135058e+00,
    +2.80658746e+00,
    +2.87507769e+00,
    +2.94680851e+00,
    +3.01948050e+00,
    +3.08998000e+00,
    +3.14905200e+00,
    +3.21091496e+00,
    +3.26017536e+00,
    +3.28682500e+00,
    +3.29077707e+00,
    +3.27507840e+00,
    +3.23928194e+00,
    +3.18403568e+00,
    +3.11102399e+00,
    +3.02031023e+00,
    +2.92162147e+00,
    +2.81314000e+00
    });


    //species: "235u" reaction: "Inelastic" from file: "json_data/235u_cross_sections.json"
    fEDCS["235u_Inelastic"] = new EnergyDependentCS(2.60000000e-02, 2.98240000e+01, {
    +7.87358000e-03,
    +8.34532764e-03,
    +8.90353557e-03,
    +9.58616339e-03,
    +1.04504357e-02,
    +1.13703551e-02,
    +1.23339150e-02,
    +1.33431855e-02,
    +1.41996930e-02,
    +1.50923832e-02,
    +1.59284320e-02,
    +1.67618676e-02,
    +1.76675315e-02,
    +2.35731199e-02,
    +3.46413760e-02,
    +4.57870596e-02,
    +6.45824323e-02,
    +8.22639046e-02,
    +9.82340974e-02,
    +1.10342653e-01,
    +1.22815232e-01,
    +1.35879502e-01,
    +1.51329159e-01,
    +1.71255441e-01,
    +1.92127013e-01,
    +2.13185477e-01,
    +2.43507403e-01,
    +2.73234354e-01,
    +2.96504621e-01,
    +3.20878815e-01,
    +3.42634634e-01,
    +3.68227227e-01,
    +3.95033917e-01,
    +4.23104306e-01,
    +4.48940652e-01,
    +4.78676460e-01,
    +5.16196195e-01,
    +5.49108252e-01,
    +5.80776577e-01,
    +6.25637584e-01,
    +6.57631252e-01,
    +6.89838269e-01,
    +7.32452645e-01,
    +7.77088620e-01,
    +8.25221543e-01,
    +8.60743117e-01,
    +8.97546103e-01,
    +9.39260771e-01,
    +9.89154300e-01,
    +1.01815314e+00,
    +1.05091560e+00,
    +1.09049469e+00,
    +1.13195140e+00,
    +1.17456401e+00,
    +1.20244388e+00,
    +1.23164635e+00,
    +1.26089458e+00,
    +1.28504726e+00,
    +1.31720174e+00,
    +1.35326574e+00,
    +1.38044321e+00,
    +1.41888346e+00,
    +1.44716249e+00,
    +1.48245025e+00,
    +1.52264610e+00,
    +1.55074782e+00,
    +1.57712097e+00,
    +1.59771759e+00,
    +1.61620221e+00,
    +1.62571067e+00,
    +1.63618412e+00,
    +1.64657544e+00,
    +1.66765237e+00,
    +1.68984796e+00,
    +1.71079549e+00,
    +1.72431379e+00,
    +1.72589844e+00,
    +1.72040265e+00,
    +1.71240037e+00,
    +1.72364592e+00,
    +1.74289210e+00,
    +1.77083069e+00,
    +1.78681880e+00,
    +1.80806608e+00,
    +1.83090720e+00,
    +1.85483188e+00,
    +1.87989153e+00,
    +1.90927884e+00,
    +1.94007138e+00,
    +1.96837836e+00,
    +1.99654226e+00,
    +2.02645435e+00,
    +2.05826583e+00,
    +2.09158642e+00,
    +2.12337453e+00,
    +2.14927297e+00,
    +2.17278032e+00,
    +2.19413039e+00,
    +2.21064465e+00,
    +2.22455690e+00,
    +2.23598356e+00,
    +2.24614432e+00,
    +2.25602043e+00,
    +2.25784900e+00,
    +2.25976432e+00,
    +2.26161752e+00,
    +2.26297216e+00,
    +2.26439107e+00,
    +2.26587729e+00,
    +2.26517578e+00,
    +2.26364296e+00,
    +2.26116436e+00,
    +2.25637567e+00,
    +2.25135982e+00,
    +2.24520856e+00,
    +2.23874729e+00,
    +2.17899349e+00,
    +2.00262160e+00,
    +1.76406352e+00,
    +1.52040262e+00,
    +1.30425358e+00,
    +1.09683716e+00,
    +9.35263466e-01,
    +8.16040305e-01,
    +7.46662821e-01,
    +6.85911164e-01,
    +6.46151135e-01,
    +6.11598503e-01,
    +5.85703328e-01,
    +5.58014450e-01,
    +5.28440424e-01,
    +4.96647458e-01,
    +4.67722169e-01,
    +4.37008212e-01,
    +3.95912843e-01,
    +3.63207204e-01,
    +3.38303101e-01,
    +3.37930142e-01,
    +3.37739654e-01,
    +3.34422731e-01,
    +3.27325296e-01,
    +3.17386804e-01,
    +3.01824393e-01,
    +2.86222209e-01,
    +2.71918152e-01,
    +2.58608727e-01,
    +2.45886387e-01,
    +2.33922963e-01,
    +2.22722900e-01,
    +2.12201103e-01,
    +2.02474181e-01,
    +1.93320632e-01,
    +1.84542000e-01
    });


    //species: "235u" reaction: "N_2N" from file: "json_data/235u_cross_sections.json"
    fEDCS["235u_N_2N"] = new EnergyDependentCS(5.32074000e+00, 2.90000000e+01, {
    +0.00000000e+00,
    +1.89722687e-02,
    +1.14351934e-01,
    +2.23459575e-01,
    +3.11618846e-01,
    +3.67038193e-01,
    +4.23167477e-01,
    +4.72630243e-01,
    +5.17991472e-01,
    +5.71496606e-01,
    +6.26167758e-01,
    +6.80019473e-01,
    +7.29603141e-01,
    +7.73175548e-01,
    +8.10542342e-01,
    +8.44210575e-01,
    +8.72298568e-01,
    +8.80108081e-01,
    +8.48750356e-01,
    +7.49721151e-01,
    +6.27755433e-01,
    +5.05699032e-01,
    +4.15449653e-01,
    +3.67125222e-01,
    +3.37034242e-01,
    +3.20290122e-01,
    +3.06372033e-01,
    +2.84846064e-01,
    +2.63545901e-01,
    +2.44181703e-01,
    +2.25867268e-01,
    +2.08428592e-01,
    +1.91797420e-01,
    +1.76851278e-01,
    +1.62186267e-01,
    +1.48397368e-01,
    +0.00000000e+00
    });


    //species: "235u" reaction: "N_3N" from file: "json_data/235u_cross_sections.json"
    fEDCS["235u_N_3N"] = new EnergyDependentCS(1.21931000e+01, 2.90000000e+01, {
    +0.00000000e+00,
    +3.49247175e-04,
    +8.06615302e-03,
    +3.78162277e-02,
    +9.12246698e-02,
    +1.47889786e-01,
    +1.93866926e-01,
    +2.21214471e-01,
    +2.48510044e-01,
    +2.64302080e-01,
    +2.69967425e-01,
    +2.61539427e-01,
    +2.39156434e-01,
    +2.09082670e-01,
    +1.80355237e-01,
    +1.57798360e-01,
    +1.39552140e-01,
    +1.23573015e-01,
    +0.00000000e+00
    });


    //species: "235u" reaction: "Fission" from file: "json_data/235u_cross_sections.json"
    fEDCS["235u_Fission"] = new EnergyDependentCS(2.50110000e-02, 2.98241000e+01, {
    +2.16040000e+00,
    +2.20591527e+00,
    +2.17427287e+00,
    +2.18904181e+00,
    +2.16484079e+00,
    +2.21049441e+00,
    +1.95959612e+00,
    +1.89607533e+00,
    +1.69701978e+00,
    +1.78676712e+00,
    +1.88415290e+00,
    +1.83033087e+00,
    +1.94677782e+00,
    +1.78249250e+00,
    +1.91174631e+00,
    +1.82573479e+00,
    +1.92075258e+00,
    +1.84774220e+00,
    +1.84872199e+00,
    +1.85896793e+00,
    +1.74798419e+00,
    +1.70754605e+00,
    +1.68042955e+00,
    +1.68432318e+00,
    +1.67523562e+00,
    +1.64456251e+00,
    +1.61243587e+00,
    +1.59354965e+00,
    +1.58482036e+00,
    +1.57894723e+00,
    +1.58653191e+00,
    +1.56585528e+00,
    +1.54419883e+00,
    +1.52151614e+00,
    +1.49943590e+00,
    +1.48742888e+00,
    +1.47485288e+00,
    +1.46168093e+00,
    +1.44788479e+00,
    +1.43343489e+00,
    +1.42125579e+00,
    +1.40901070e+00,
    +1.39993823e+00,
    +1.38864378e+00,
    +1.36575315e+00,
    +1.34714938e+00,
    +1.34854951e+00,
    +1.32343264e+00,
    +1.30000109e+00,
    +1.29366167e+00,
    +1.27728319e+00,
    +1.25709996e+00,
    +1.23762402e+00,
    +1.23228301e+00,
    +1.23168630e+00,
    +1.23469003e+00,
    +1.22852795e+00,
    +1.21611496e+00,
    +1.21776760e+00,
    +1.20655620e+00,
    +1.18717032e+00,
    +1.19996688e+00,
    +1.17805507e+00,
    +1.15292656e+00,
    +1.14086092e+00,
    +1.14135888e+00,
    +1.13061233e+00,
    +1.13197792e+00,
    +1.12702193e+00,
    +1.11208858e+00,
    +1.11792477e+00,
    +1.11881221e+00,
    +1.11717900e+00,
    +1.12734738e+00,
    +1.12381250e+00,
    +1.11163091e+00,
    +1.11850357e+00,
    +1.13593959e+00,
    +1.16252336e+00,
    +1.20174184e+00,
    +1.20216999e+00,
    +1.19723038e+00,
    +1.19565425e+00,
    +1.20183063e+00,
    +1.20829970e+00,
    +1.21507532e+00,
    +1.22217202e+00,
    +1.22960501e+00,
    +1.23739445e+00,
    +1.24611846e+00,
    +1.25525589e+00,
    +1.26251090e+00,
    +1.26922691e+00,
    +1.27626117e+00,
    +1.28362877e+00,
    +1.28681312e+00,
    +1.28202168e+00,
    +1.27700319e+00,
    +1.27101260e+00,
    +1.26441556e+00,
    +1.25786751e+00,
    +1.24949399e+00,
    +1.23805046e+00,
    +1.22376487e+00,
    +1.20939334e+00,
    +1.19717062e+00,
    +1.18436869e+00,
    +1.17096011e+00,
    +1.15746978e+00,
    +1.14542701e+00,
    +1.13414124e+00,
    +1.12661304e+00,
    +1.11872810e+00,
    +1.10192997e+00,
    +1.08227420e+00,
    +1.06602444e+00,
    +1.04976792e+00,
    +1.03829745e+00,
    +1.06518914e+00,
    +1.17028108e+00,
    +1.31918358e+00,
    +1.45047731e+00,
    +1.57491025e+00,
    +1.68129116e+00,
    +1.74553175e+00,
    +1.78763164e+00,
    +1.79167113e+00,
    +1.78222709e+00,
    +1.77233551e+00,
    +1.76197520e+00,
    +1.75147332e+00,
    +1.74090187e+00,
    +1.71786633e+00,
    +1.71433696e+00,
    +1.78268648e+00,
    +1.87990920e+00,
    +1.99715136e+00,
    +2.08376336e+00,
    +2.11860253e+00,
    +2.14287794e+00,
    +2.13516604e+00,
    +2.09393060e+00,
    +2.06206614e+00,
    +2.03856591e+00,
    +2.02530039e+00,
    +2.06099584e+00,
    +2.10412752e+00,
    +2.13294664e+00,
    +2.10788889e+00,
    +2.11858321e+00,
    +2.12813832e+00,
    +2.11336560e+00,
    +2.12069284e+00,
    +2.14626000e+00
    });

    //species: "238u" reaction: "Elastic" from file: "json_data/238u_cross_sections.json"
    fEDCS["238u_Elastic"] = new EnergyDependentCS(2.50302000e-02, 2.98240000e+01, {
    +1.34609000e+01,
    +1.34435942e+01,
    +1.34254383e+01,
    +1.34064139e+01,
    +1.33865418e+01,
    +1.33298425e+01,
    +1.32654429e+01,
    +1.31979314e+01,
    +1.31272276e+01,
    +1.30532326e+01,
    +1.29756456e+01,
    +1.28944079e+01,
    +1.28093216e+01,
    +1.27261981e+01,
    +1.26847028e+01,
    +1.26411871e+01,
    +1.25975409e+01,
    +1.25586062e+01,
    +1.24153576e+01,
    +1.22609032e+01,
    +1.20990944e+01,
    +1.19637803e+01,
    +1.18775593e+01,
    +1.17872310e+01,
    +1.17074575e+01,
    +1.16603213e+01,
    +1.16109010e+01,
    +1.15522467e+01,
    +1.14632546e+01,
    +1.13411864e+01,
    +1.11016449e+01,
    +1.10334877e+01,
    +1.09621615e+01,
    +1.08874274e+01,
    +1.08091707e+01,
    +1.07231571e+01,
    +1.06292660e+01,
    +1.05309121e+01,
    +1.04279195e+01,
    +1.03056192e+01,
    +1.01609333e+01,
    +1.00307838e+01,
    +9.90757522e+00,
    +9.77852877e+00,
    +9.64336780e+00,
    +9.50406040e+00,
    +9.37725076e+00,
    +9.24443258e+00,
    +9.10532117e+00,
    +8.95961834e+00,
    +8.82113419e+00,
    +8.68172691e+00,
    +8.53571419e+00,
    +8.38278305e+00,
    +8.22362972e+00,
    +8.07824916e+00,
    +7.92598012e+00,
    +7.77450829e+00,
    +7.63155422e+00,
    +7.48182666e+00,
    +7.32500465e+00,
    +7.17435828e+00,
    +7.02310419e+00,
    +6.87056993e+00,
    +6.71757005e+00,
    +6.56269698e+00,
    +6.42869010e+00,
    +6.28833366e+00,
    +6.14132681e+00,
    +5.99301164e+00,
    +5.85762118e+00,
    +5.72799636e+00,
    +5.54694786e+00,
    +5.36295198e+00,
    +5.17458920e+00,
    +4.99061532e+00,
    +4.83373871e+00,
    +4.68967331e+00,
    +4.53971805e+00,
    +4.37540223e+00,
    +4.20086360e+00,
    +4.04680103e+00,
    +3.89659081e+00,
    +3.77782969e+00,
    +3.68587763e+00,
    +3.61205601e+00,
    +3.55368492e+00,
    +3.49879933e+00,
    +3.46005464e+00,
    +3.43856437e+00,
    +3.43004087e+00,
    +3.43714116e+00,
    +3.45238556e+00,
    +3.47841067e+00,
    +3.51393524e+00,
    +3.56923732e+00,
    +3.63134650e+00,
    +3.70617714e+00,
    +3.78455344e+00,
    +3.86664338e+00,
    +3.96738099e+00,
    +4.05677392e+00,
    +4.14288240e+00,
    +4.21859175e+00,
    +4.29426949e+00,
    +4.35359793e+00,
    +4.41573750e+00,
    +4.45670862e+00,
    +4.47851356e+00,
    +4.48899839e+00,
    +4.49180550e+00,
    +4.48203539e+00,
    +4.44416541e+00,
    +4.39787536e+00,
    +4.33483442e+00,
    +4.25653158e+00,
    +4.15751991e+00,
    +4.05365828e+00,
    +3.94248359e+00,
    +3.82246846e+00,
    +3.68953566e+00,
    +3.55164034e+00,
    +3.41489764e+00,
    +3.28521477e+00,
    +3.16152464e+00,
    +3.04806849e+00,
    +2.94572088e+00,
    +2.86035315e+00,
    +2.79418798e+00,
    +2.73935547e+00,
    +2.70562367e+00,
    +2.68876714e+00,
    +2.68930549e+00,
    +2.69770625e+00,
    +2.72535967e+00,
    +2.76400521e+00,
    +2.81821960e+00,
    +2.87594645e+00,
    +2.94240406e+00,
    +3.01648925e+00,
    +3.09209775e+00,
    +3.16696438e+00,
    +3.23397094e+00,
    +3.28872041e+00,
    +3.33001019e+00,
    +3.35491518e+00,
    +3.36832651e+00,
    +3.36516734e+00,
    +3.33982398e+00,
    +3.29050994e+00,
    +3.23196623e+00,
    +3.15616971e+00,
    +3.06686404e+00,
    +2.97029000e+00
    });


    //species: "238u" reaction: "Inelastic" from file: "json_data/238u_cross_sections.json"
    fEDCS["238u_Inelastic"] = new EnergyDependentCS(4.51063000e-02, 2.90000000e+01, {
    +1.07404186e-16,
    +3.30024009e-02,
    +6.75647958e-02,
    +9.51315704e-02,
    +1.21361625e-01,
    +1.44255254e-01,
    +1.66283141e-01,
    +1.95417385e-01,
    +2.27269972e-01,
    +2.60628203e-01,
    +2.90809827e-01,
    +3.17246341e-01,
    +3.53790051e-01,
    +3.87291257e-01,
    +4.18974615e-01,
    +4.51922949e-01,
    +4.81170893e-01,
    +5.11801362e-01,
    +5.40886336e-01,
    +5.70389930e-01,
    +6.01288133e-01,
    +6.33646866e-01,
    +6.70728341e-01,
    +7.10306589e-01,
    +7.51755665e-01,
    +7.89133393e-01,
    +8.21563081e-01,
    +8.55904355e-01,
    +8.88573613e-01,
    +9.20402350e-01,
    +9.53735603e-01,
    +9.87660419e-01,
    +1.02191919e+00,
    +1.05502556e+00,
    +1.08877312e+00,
    +1.12411591e+00,
    +1.16112931e+00,
    +1.19491585e+00,
    +1.22907987e+00,
    +1.26485879e+00,
    +1.30232895e+00,
    +1.34157029e+00,
    +1.37418078e+00,
    +1.40811983e+00,
    +1.44192977e+00,
    +1.47242731e+00,
    +1.50436644e+00,
    +1.53781531e+00,
    +1.57026639e+00,
    +1.60335564e+00,
    +1.63923980e+00,
    +1.67729709e+00,
    +1.71715332e+00,
    +1.74939227e+00,
    +1.78293965e+00,
    +1.82016831e+00,
    +1.85915673e+00,
    +1.89433001e+00,
    +1.92439635e+00,
    +1.96546088e+00,
    +2.07120883e+00,
    +2.16387792e+00,
    +2.25257340e+00,
    +2.33204232e+00,
    +2.40063361e+00,
    +2.46636201e+00,
    +2.54777388e+00,
    +2.67643565e+00,
    +2.79184834e+00,
    +2.90875253e+00,
    +2.99517140e+00,
    +3.08370683e+00,
    +3.14457151e+00,
    +3.17752132e+00,
    +3.17181547e+00,
    +3.12472485e+00,
    +3.08361670e+00,
    +3.07682823e+00,
    +3.09285243e+00,
    +3.11243019e+00,
    +3.12766217e+00,
    +3.13523197e+00,
    +3.14889277e+00,
    +3.15759864e+00,
    +3.15743389e+00,
    +3.16296846e+00,
    +3.16744052e+00,
    +3.14523560e+00,
    +3.13026216e+00,
    +3.10673419e+00,
    +3.09273391e+00,
    +3.07650031e+00,
    +3.04685505e+00,
    +3.02397610e+00,
    +3.00045189e+00,
    +2.97651409e+00,
    +2.95172731e+00,
    +2.92576888e+00,
    +2.89871463e+00,
    +2.87184983e+00,
    +2.84527900e+00,
    +2.81906667e+00,
    +2.79276765e+00,
    +2.76747431e+00,
    +2.74098539e+00,
    +2.70441143e+00,
    +2.63850467e+00,
    +2.49858947e+00,
    +2.22263009e+00,
    +1.88103188e+00,
    +1.57349424e+00,
    +1.29916094e+00,
    +1.09767360e+00,
    +9.62352876e-01,
    +8.61234970e-01,
    +7.89106467e-01,
    +7.34812014e-01,
    +6.94268113e-01,
    +6.60872591e-01,
    +6.31738057e-01,
    +6.04499758e-01,
    +5.78825921e-01,
    +5.54564168e-01,
    +5.31125611e-01,
    +5.08209072e-01,
    +4.85829934e-01,
    +4.64344274e-01,
    +4.43711606e-01,
    +4.24215232e-01,
    +4.05332189e-01,
    +3.87305528e-01,
    +3.70441321e-01,
    +3.54922059e-01,
    +3.39767350e-01,
    +3.25901540e-01,
    +3.12795947e-01,
    +3.00959091e-01,
    +2.90215927e-01,
    +2.80266731e-01,
    +2.71040335e-01,
    +0.00000000e+00
    });


    //species: "238u" reaction: "N_2N" from file: "json_data/238u_cross_sections.json"
    fEDCS["238u_N_2N"] = new EnergyDependentCS(6.17907000e+00, 2.90000000e+01, {
    +0.00000000e+00,
    +6.64573007e-02,
    +3.23724498e-01,
    +5.91865858e-01,
    +8.50287229e-01,
    +1.02406688e+00,
    +1.16103715e+00,
    +1.26459120e+00,
    +1.33861677e+00,
    +1.38223171e+00,
    +1.41564615e+00,
    +1.43421611e+00,
    +1.44795234e+00,
    +1.45898538e+00,
    +1.45895141e+00,
    +1.40583589e+00,
    +1.25013096e+00,
    +1.03111989e+00,
    +8.01642187e-01,
    +6.05224384e-01,
    +4.70249941e-01,
    +3.73796645e-01,
    +3.07927838e-01,
    +2.65280499e-01,
    +2.37428550e-01,
    +2.17573432e-01,
    +2.01467136e-01,
    +1.86792303e-01,
    +1.73745374e-01,
    +1.61841399e-01,
    +1.50245435e-01,
    +1.39156691e-01,
    +1.27763060e-01,
    +0.00000000e+00
    });


    //species: "238u" reaction: "N_3N" from file: "json_data/238u_cross_sections.json"
    fEDCS["238u_N_3N"] = new EnergyDependentCS(1.13268000e+01, 2.90000000e+01, {
    +0.00000000e+00,
    +6.19119348e-03,
    +5.60996422e-02,
    +1.82935715e-01,
    +3.46891016e-01,
    +5.05447913e-01,
    +6.35510376e-01,
    +7.27086838e-01,
    +7.94872755e-01,
    +8.41545624e-01,
    +8.70170874e-01,
    +8.75314700e-01,
    +8.27014278e-01,
    +7.21518688e-01,
    +5.88320804e-01,
    +4.59298180e-01,
    +3.52672921e-01,
    +2.82530142e-01,
    +2.32304859e-01,
    +1.98536741e-01,
    +0.00000000e+00
    });


    //species: "238u" reaction: "Fission" from file: "json_data/238u_cross_sections.json"
    fEDCS["238u_Fission"] = new EnergyDependentCS(2.50189000e-02, 2.98240000e+01, {
    +8.33090000e-05,
    +6.45922044e-05,
    +5.15351477e-05,
    +3.83037502e-05,
    +2.41371513e-05,
    +1.68775577e-05,
    +1.87101046e-05,
    +2.56750160e-05,
    +3.08176816e-05,
    +3.75721844e-05,
    +5.01209568e-05,
    +6.62589116e-05,
    +8.12808247e-05,
    +9.58586645e-05,
    +1.07485122e-04,
    +1.15224610e-04,
    +1.12556614e-04,
    +1.07085337e-04,
    +1.05249862e-04,
    +1.02016890e-04,
    +9.17231551e-05,
    +7.86164891e-05,
    +6.47743291e-05,
    +5.01046934e-05,
    +3.47239401e-05,
    +2.08909083e-05,
    +1.45259110e-05,
    +1.27420626e-05,
    +1.86251431e-05,
    +3.64112849e-05,
    +5.50337252e-05,
    +6.66062694e-05,
    +7.90280084e-05,
    +9.66540829e-05,
    +1.20665847e-04,
    +1.50784930e-04,
    +1.77708681e-04,
    +1.92823125e-04,
    +1.74050284e-04,
    +9.00677779e-05,
    +6.22557723e-05,
    +6.56093966e-05,
    +6.71810884e-05,
    +6.94779973e-05,
    +7.18837462e-05,
    +7.44034924e-05,
    +7.70426378e-05,
    +7.98068403e-05,
    +8.27020256e-05,
    +8.57344005e-05,
    +9.16387430e-05,
    +1.04959948e-04,
    +1.18912383e-04,
    +1.33525960e-04,
    +1.48832008e-04,
    +1.64863339e-04,
    +1.81654322e-04,
    +1.99240952e-04,
    +2.17660931e-04,
    +2.36953749e-04,
    +2.57160766e-04,
    +2.78325299e-04,
    +3.00492724e-04,
    +3.02132382e-04,
    +2.88197345e-04,
    +4.15159971e-04,
    +6.35117079e-04,
    +6.51621168e-04,
    +9.00954074e-04,
    +1.22492344e-03,
    +1.29857048e-03,
    +1.54964508e-03,
    +1.91820396e-03,
    +2.45752501e-03,
    +3.46765521e-03,
    +4.93410022e-03,
    +6.67766400e-03,
    +1.18631844e-02,
    +1.62188287e-02,
    +1.61033291e-02,
    +1.67373982e-02,
    +2.30128932e-02,
    +3.42747674e-02,
    +4.34952709e-02,
    +4.12229673e-02,
    +6.26162262e-02,
    +1.09131336e-01,
    +2.03566779e-01,
    +3.33198373e-01,
    +3.84147792e-01,
    +4.26101623e-01,
    +4.50728374e-01,
    +4.90114328e-01,
    +5.19031187e-01,
    +5.39368409e-01,
    +5.39861433e-01,
    +5.45504108e-01,
    +5.49143598e-01,
    +5.47716469e-01,
    +5.46221715e-01,
    +5.43951013e-01,
    +5.41552994e-01,
    +5.38549879e-01,
    +5.29787790e-01,
    +5.29505507e-01,
    +5.35078541e-01,
    +5.40915655e-01,
    +5.47029364e-01,
    +5.51725649e-01,
    +5.55019616e-01,
    +5.58323148e-01,
    +5.60295815e-01,
    +5.62361957e-01,
    +5.60828460e-01,
    +5.52810051e-01,
    +5.49902860e-01,
    +5.49668707e-01,
    +5.56408785e-01,
    +5.89159546e-01,
    +6.75114765e-01,
    +8.05322997e-01,
    +8.88169216e-01,
    +9.53836954e-01,
    +9.87212535e-01,
    +9.99291615e-01,
    +1.01599963e+00,
    +1.01488716e+00,
    +1.01658769e+00,
    +1.01440945e+00,
    +1.01156677e+00,
    +1.01006154e+00,
    +1.00947698e+00,
    +1.00701072e+00,
    +9.94242334e-01,
    +1.00182376e+00,
    +1.02384832e+00,
    +1.09740964e+00,
    +1.16796827e+00,
    +1.23049464e+00,
    +1.28576846e+00,
    +1.31711646e+00,
    +1.32021167e+00,
    +1.31956603e+00,
    +1.34828172e+00,
    +1.38912457e+00,
    +1.47219994e+00,
    +1.54101346e+00,
    +1.58255446e+00,
    +1.56364139e+00,
    +1.56995770e+00,
    +1.57565256e+00,
    +1.57259111e+00,
    +1.60974675e+00,
    +1.65609000e+00
    });


}

